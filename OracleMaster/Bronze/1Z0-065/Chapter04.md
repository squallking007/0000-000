# 第四章 Oracleネットワーク環境の構成

## 4.1 Oracleのネットワーク構成

**ネットワーク構成の概要　★★★**

+ ```クライアント／サーバーアプリケーションによる接続```では、**クライアント**と**データベースサーバー**の両方にOracle Netをインストールする。

+ ```Webクライアント接続```では、**Webサーバー**と**データベースサーバー**の両方にOracle Netをインストールする。

## 4.2 リスナープロセス

+ **リスナープロセスの役割　★★★**

+ リスナープロセスは**データベースサーバー側**で動作しているプロセスです。

+ リスナーは、**クライアントから**の接続要求を受け付け、データベースに転送する。

+ リスナーが起動していない場合は、クライアントからデータベースサーバーへ**接続することができない**。

+ **リスナーの制御　★★★**

+ リスナーは、デフォルトでは**自動起動するようになっていません**。

+ リスナーを起動したり、起動中のリスナーを停止したりするには```リスナー制御ユーティリティ(lsnrctl)```を使用する。

+ リスナーを制御する場合は、以下のコマンドを実行する。

|コマンド |説明 |
|---- |---- |
|lsnrctl start [リスナー名] |リスナーの起動 |
|lsnrctl stop [リスナー名] |リスナーの停止 |
|lsnrctl status [リスナー名] |リスナーの状態の確認 |
|lsnrctl services [リスナー名] |サポート対象のサービスの確認 |

+ lsnrctlを使用するリスナーがを制御する場合は、デフォルトのリスナー名(LISTENER)の場合は、リスナー名の指定は**省略できる**。

+ **リスナーの構成　★★★**

+ リスナーの構成情報は以下の通り、```$ORACLE_HOME/network/admin/listener.ora```ファイルに格納される。

    + 1つ以上のプロトコルアドレス
    
    + サポート対象のサービスい関する情報
    
    + 実行時の動作を制御するパラメータ

+ listener.oraファイルは、データベースを作成する場合、**作成されていない**。

+ listener.oraファイルを作成するには、Oracleネットワークの構成をするための以下のツールを使用する。

    + Oracle NetManager
    
    + Oracle Net Configuration Assistant (NetCA)
    
    + Enterprise Manager Cloud Control
    
## 4.3 クライアントの構成

+ **サービスとは　★★★★**

+ データベースは、クライアントからは1つの```「サービス」```として見える。

+ クライアントはサービスを指定して、データベースサーバー上のデータベースに接続する。

+ データベースのサービス名は**```SERVICE_NAME```初期化パラメータ**で指定する。

+ SERVICE_NAME初期化パラメータのデフォルトは**グローバルデータベース名**です。通常は以下の要素で構成される。

```
データベース名(DB_NAMEパラメータ値) + ドメイン名(DB_DOMAINパラメータ値)
```

+ **データベースの接続　★★★★**

+ クライアントは```データベースの場所```と```サービス名```を指定して、データベースサーバー上のデータベースに接続する。

+ データベースの接続情報は```「接続記述子」```という。

+ 接続記述子例

```
(DESCRIPTION=
    (ADDRESS=(PROTOCOL=tcp) (HOST=proj1-sv) (PORT=1521))
    (CONNECT_DATA=
        (SERVICE_NAME=sales.edifist.com)))
```

    プロトコル：TCP/IP
    ホスト名：proj1-sv
    ポート番号：1521
    サービス名:sales.edifist.com

+ クライアントからデータベースに接続するには```「接続文字列」```を指定する。必要な項目は、```ユーザー名```、```パスワード```、```＠```、```接続識別子```で構成されている。

+ ```接続識別子```は、データベースへ接続するための情報です。

+ ネットサービス名とは、**接続記述子に付けた単純な名前**です。

+ ネットサービス名

```
test = (DESCRIPTION=
    (ADDRESS=(PROTOCOL=tcp) (HOST=proj1-sv) (PORT=1521))
    (CONNECT_DATA=
        (SERVICE_NAME=sales.edifist.com)))
```

+ ネットサービス名を使用した接続文字列

```sql
sqlplus /nolog
connect ユーザー名/パスワード@ネットサービス名
```

+ **ネーミングメソッド　★★★★**

+ ```ネーミングメソッド```とは、ネットサービス名を接続記述子に変換する方法である。

+ 情報リポジトリとは、**ネットサービス名と接続記述子のマッピング情報**を格納している場所です。

+ tnsnames.oraファイルは、クライアントのローカルに置く。

+ tnsnames.oraにはネットサービス名と接続記述子が登録される。

+ 簡易接続ネーミングでは、ネットサービス名は作成せずに、クライアントから直接TCP/IP接続文字列を入力して接続する。

```sql
connect ユーザー名 / パスワード @ ホスト名[:ポート番号][/サービス名]
```

## リンク

- [ディレクトリ](./../directory.md)

- 前章：[第三章 EM ExpressおよびSQLベースの管理ツールの使用](Chapter03.md)

- 次章：[第五章 Oracleインスタンスの管理](Chapter05.md)
