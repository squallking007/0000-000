# 第六章 データベース記憶域構造の管理

## 6.1 データベース記憶域構造の管理

**データベース記憶域構造の概要　★★★★**

+ データベースの物理構造として、以下の３種類のファイルを覚えてください。

|ファイル名 |説明 |
|---- |---- |
|**制御ファイル** |**物理構造に関する情報**が格納される(データベースを構成するファイル群のパス名など) |
|**REDOログファイル**|データに対して行われた**変更情報**が格納される|
|**データファイル** |すべての表や索引の**データ**が格納される|

+ データベースの論理構造は、データベースによって作成されます。主な構造は「```表領域```」です。

+  ```表領域```は、表や索引などのデータベースのオブジェクトを格納する入れ物と考えることができます。

+ 各表領域に対して**１つ以上のデータファイル**が作成されます。

+ データベースでは、表(データ)を、論理的には表領域に格納し、物理的には表領域に関連付けられたデータファイルに格納する。

+ データベースの記憶域構造は、EM Expressの「```記憶域```」メニューで確認できる。

**制御ファイル　★★★★★**

+  ```制御ファイル```は、データベースの物理構造の情報が記録された**バイナリファイル**です。**データベースのマウント時**に読み込まれます。

+  ```制御ファイルのファイル名```は「CONTORL_FILES」初期化パラメータで指定する。インスタンスの起動時に読み込まれって、制御ファイルのパス名が確認され、データベースのマウント時に制御ファイルが読み込まれて、すべてのデータファイルとREDOログファイルのパス名が確認される。

+ 制御ファイルは**データベースによって自動的に更新される**。

+ 制御ファイルの損失によるデータベース障害に対応するために、通常は制御ファイルは多重化しておく。

+ EM Expressを使用して、制御ファイルの情報を確認できる。

**REDOログファイル　★★★**

+  ```REDOログファイル```は、ユーザーがSQL文を使用して行った**トランザクションの内容**やデータベースが内部的に行った**データベースへの変更**が記録されるファイルです。

+ REDOログファイルは、データベースのリカバリの機能を担保する。

+ トランザクションの変更情報である```REDOレコード```は、一時的にSGA内の```RADOログバッファ```に書き込まれます。RADOログバッファのRADOレコードは、トランザクションのCOMMIT時に、```LGWR(ログライター)```プロセスによって```REDOログファイル```に書き込まれる。

+ REDOログファイルは必ず**２つ以上のREDOロググループ**で構成され、```LGWR```は各グループに対して、**循環方式**で書き込みを行う。

+ **各REDOロググループには１つ以上のREDOログファイル**が含まれる。１つのグループ内に複数のファイルが構成されている場合、それらのファイルには**同一の内容が書き込まれる**。

+ 各グループはログ**順序番号**で識別される。

+ LGWRの書き込み対象のREDOログファイルを含むグループのことを「```カレントのREDOロググループ```」と言います。

+ REDOログファイルの書き込み先が切り替わることを「「```ログスイッチ```」と言います。ログスイッチはALTER SYSTEM SWITCH LOGFILE文によって手動で実行することもできます。

+  ```アーカイブログファイル```は、REDOログファイルが上書きされる前にコピーされたファイルである。

+  アーカイブログファイルは、**ARCn**が作成する。

+  グループ内のそれぞれのREDOログファイルを「**メンバー**」といい、グループないに２つ以上のメンバーがある状態が多重化されている状態である。

+  障害に備えるために、２つ以上のREDOログファイルの同一のコピーを別々のディスクに保持できるように多重化することが推奨されている。

**表領域とデータファイル　★★★★★**









## リンク

- [ディレクトリ](./../directory.md)

- 前章：[第五章 Oracleインスタンスの管理](Chapter05.md)

- 次章：[第七章 ユーザーおよびセキュリティの管理](Chapter07.md)
