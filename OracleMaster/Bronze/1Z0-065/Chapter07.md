# 第七章 ユーザーおよびセキュリティの管理

## 7.1 ユーザーの管理とセキュリティの管理

**ユーザーアカウントの作成　★★★★**

- ```ユーザー属性```情報はSYSTEM表領域の**データディクショナリ**に格納されます。

|ユーザー属性 |説明 |
|---- |---- |
|名前 |ユーザーアカウントを識別する名前。**ユーザー名**という。 |
|データベース認証パスワード |ユーザー名対する**パスワード**。<br>パスワードはデータディクショナリに暗号化されて格納される。<br>Oracle Database 12cでは、大文字・小文字が区別される。 |
|デフォルト表領域 |ユーザーがオブジェクトを作成する際に、そのオブジェクトの格納先を指定しなかった場合に使用される表領域。<br>デフォルト表領域を指定しない場合は、**デフォルトの永続表領域**が暗黙的に設定される。 |
|一時表領域 |ユーザーが「**一時セグメントの作成を必要とするSQL文**」を実行した際に使用される表領域。<br>一時表領域を指定しない場合はデフォルトの一時表領域が暗黙的に指定される。 |
|表領域の割当て制限 |ユーザーに対して、使用を許可する**表領域の容量**。<br>ユーザーが使用可能な表領域ごとに設定する。<br>一時表領域やUNDO表領域は割当て制限の設定がなくても使用できる。 |
|アカウントステータス<br>(ロックまたはロック解除) |ログインできる状態(**ロック解除**)、またはログイン禁止の状態(ロック)を指定する。<br>ロックされている場合は、データベース管理者がロックを解除する必要がある。 |
|パスワードステータス<br>(有効または無効) |パスワードを無効(**期限切れ**)にするか、有効にするかを指定する。<br>無効になった場合、次回のログイン時にパスワードを変更する必要がある。 |

- データベース管理者は、ユーザーアカウントをあらかじめデータベースに作成しておく。

- ユーザーがデータベースにアクセスするには、接続時に有効なユーザー名、パスワードを入力し、データベースで認証を受ける必要がある。

- ユーザーアカウントを作成する際に、ユーザー属性をしているす。

- 新しく作成したユーザーアカウントを使用してデータベースに接続するには、**CREATE SESSIONシステム権限**が付与されているひつようがある。

- ```EM Express```または```SQL文```を使用し、ユーザーアカウントを作成できる。

- SQL文でユーザーアカウントの作成

```SQL
CREATE USER ユーザー名
    IDENTIFIED BY パスワード
    [DEFAULT TABLESPACE 表領域名]
    [TEMPORARY TABLESPACE 表領域名]
    [QUOTA サイズ ON 表領域名]
    [PROFILE プロファイル];
```

- 主な事前定義された管理者アカウント一覧

|ユーザー名 |説明 |
|---- |---- |
|SYS |データベース管理者アカウント<br>データベースの管理情報を格納するデータディクショナリのすべての実表とビューを所有する。 |
|SYSTEM |データベース管理者アカウント。<br>管理情報を表示する表やビュー、Oracleデータベースのオブジェクトやツールで使用する内部的な表やビューを所有する。 |
|SYSMAN |Enterprise Managerによるデータベース操作を実行するためのユーザーアカウント。 |
|DBSMNP |Enterprise Managerの管理エージェントがデータベースの監視および管理を行うために使用するユーザーアカウント。 |

- 「SYS」、「SYSTEM」、「SYSMAN」、「DBSMNP」の４つの管理者アカウントは**データベース作成時に自動的に作成される**。

- データベース作成時にサンプルスキーマを作成すると、「HR(Human Resources)」、「OE(Order Entry)」、「SH(Sales History)」などの**サンプルスキーマユーザー**が作成されます。

**ユーザー属性の変更　★★★★**

- ユーザー属性は、ユーザーアカウントお作成後に**変更できます**。

- ```EM Express```または```SQL文```を使用した、ユーザー属性を変更できる。

- SQL文を使用したユーザー属性の変更

```SQL
ALTER USER ユーザー名
    [IDENTIFIED BY パスワード]
    [DEFAULT TABLESPACE 表領域名]
    [TEMPORARY TABLESPACE 表領域名]
    [QUOTA サイズ ON 表領域名]
    [PROFILE プロファイル];
```

**ユーザーアカウントの削除　★★★★**

- ユーザーアカウントを削除すると、**ユーザー名が所有していた表や索引などのすべてのオブジェクトも削除されます**。

- ```EM Express```または```SQL文```を使用した、ユーザーアカウントを削除できる。

- SQL文を使用したユーザーアカウントの削除

```SQL
DROP USER ユーザー名 [CASCADE];
```

- 削除しようとしているユーザーがデータベースへ接続中の場合はエラーが表示され、削除できない。

- 削除しようとしているユーザーがオブジェクトを所有している場合は、所有するオブジェクトをすべて削除するか、「```CASCADE```」を指定しないと削除できない。

**ユーザーアカウントのロック／ロック解除　★★★**

- ```EM Express```または```SQL文```を使用した、ユーザーアカウントをロック／ロック解除できる。

- SQL文を使用したユーザーアカウントのロックおよびロック解除

```SQL
// ロックの設定
ALTER USER ユーザー名 ACCOUNT LOCK;

// ロックの解除
ALTER USER ユーザー名 ACCOUNT UNLOCK;
```

- ユーザーアカウントをロックして、特定のユーザーアカウントによるデータベースへのアクセスを一時的に拒否することができる。

- ロックされているユーザーアカウントで接続したい場合は、管理者がロックを解除する必要がある。

**パスワードポリシー　★★★**

- パスワードポリシーによって、ユーザーに対して最低文字数や有効期限といった、**パスワードに関するルール**を設定できる。

- ユーザーアカウントを作成すると、「```プロファイル```」というデータベースオブジェクトを介して、デフォルトのパスワードポリシーが自動的に割当てられる。

- ```プロファイル```は、ユーザーには**必ず１つ**のプロファイルが割当てられる。明示的に割当てられていない場合は、「```DEFAULT```」という名前のプロファイルが割当てられる。

- デフォルトのパスワードポリシーは下記のような設定になっています。

  + ユーザーアカウントのパスワードは**180日**で自動的に期限切れとなる。

  + パスワードの期限切れの後、最初にログインした**７日後**にユーザーアカウントがロックされるので、最初のログイン後７日以内にパスワードを変更する必要がある。

  + ログインに**１０回**失敗すると、ユーザーアカウントが**１日**ロックされる。

- ```EM Express```を使用してデフォルトのパスワードポリシーを変更できる。

## 7.2 データベース操作のための権限付与










## リンク

- [ディレクトリ](./../directory.md)

- 前章：[第六章 データベース記憶域構造の管理](Chapter06.md)

- 次章：[第八章 スキーマオブジェクトの管理](Chapter08.md)
